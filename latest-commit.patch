From d803b7d9e251e13e233ee6d737ad780249650959 Mon Sep 17 00:00:00 2001
From: Mshari AS <mshari-as@firstlineon.com>
Date: Thu, 3 Jul 2025 04:00:50 +0300
Subject: [PATCH] =?UTF-8?q?=F0=9F=9A=80=20=D8=A5=D9=86=D8=B4=D8=A7=D8=A1?=
 =?UTF-8?q?=20=D8=B5=D9=81=D8=AD=D8=A9=20admin.html=20=D8=AC=D8=AF=D9=8A?=
 =?UTF-8?q?=D8=AF=D8=A9=20=D8=A8=D8=A7=D9=84=D9=83=D8=A7=D9=85=D9=84=20-?=
 =?UTF-8?q?=20=D9=84=D9=88=D8=AD=D8=A9=20=D8=A5=D8=AF=D8=A7=D8=B1=D8=A9=20?=
 =?UTF-8?q?=D8=B4=D8=A7=D9=85=D9=84=D8=A9=20=D9=88=D8=B9=D8=B5=D8=B1=D9=8A?=
 =?UTF-8?q?=D8=A9?=
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

---
 admin.html | 1061 ----------------------------------------------------
 1 file changed, 1061 deletions(-)

diff --git a/admin.html b/admin.html
index dfb5b43..e69de29 100644
--- a/admin.html
+++ b/admin.html
@@ -1,1061 +0,0 @@
-<!DOCTYPE html>
-<html lang="ar" dir="rtl">
-<head>
-    <meta charset="UTF-8">
-    <meta name="viewport" content="width=device-width, initial-scale=1.0">
-    <title>لوحة التحكم - First Line</title>
-    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
-    <style>
-        * {
-            margin: 0;
-            padding: 0;
-            box-sizing: border-box;
-            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
-        }
-        
-        body {
-            background: #f8f9fa;
-            min-height: 100vh;
-        }
-        
-        .login-container {
-            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
-            min-height: 100vh;
-            display: flex;
-            align-items: center;
-            justify-content: center;
-            padding: 20px;
-        }
-        
-        .login-form {
-            background: white;
-            border-radius: 20px;
-            padding: 40px;
-            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
-            width: 100%;
-            max-width: 400px;
-            text-align: center;
-        }
-        
-        .login-form .logo {
-            width: 80px;
-            height: 80px;
-            background: linear-gradient(135deg, #667eea, #764ba2);
-            border-radius: 50%;
-            margin: 0 auto 30px;
-            display: flex;
-            align-items: center;
-            justify-content: center;
-            color: white;
-            font-size: 2rem;
-        }
-        
-        .dashboard-container {
-            display: none;
-        }
-        
-        .header {
-            background: linear-gradient(135deg, #667eea, #764ba2);
-            color: white;
-            padding: 20px;
-            display: flex;
-            justify-content: space-between;
-            align-items: center;
-        }
-        
-        .header h1 {
-            font-size: 1.5rem;
-        }
-        
-        .user-info {
-            display: flex;
-            align-items: center;
-            gap: 15px;
-        }
-        
-        .logout-btn {
-            background: rgba(255,255,255,0.2);
-            border: none;
-            color: white;
-            padding: 10px 20px;
-            border-radius: 10px;
-            cursor: pointer;
-            transition: background 0.3s ease;
-        }
-        
-        .logout-btn:hover {
-            background: rgba(255,255,255,0.3);
-        }
-        
-        .main-content {
-            padding: 30px;
-        }
-        
-        .stats-grid {
-            display: grid;
-            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
-            gap: 20px;
-            margin-bottom: 30px;
-        }
-        
-        .stat-card {
-            background: white;
-            border-radius: 15px;
-            padding: 25px;
-            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
-            text-align: center;
-            border-left: 5px solid;
-        }
-        
-        .stat-card.total {
-            border-left-color: #667eea;
-        }
-        
-        .stat-card.pending {
-            border-left-color: #ffc107;
-        }
-        
-        .stat-card.approved {
-            border-left-color: #28a745;
-        }
-        
-        .stat-card.rejected {
-            border-left-color: #dc3545;
-        }
-        
-        .stat-number {
-            font-size: 2.5rem;
-            font-weight: bold;
-            margin-bottom: 10px;
-        }
-        
-        .stat-label {
-            color: #666;
-            font-size: 1.1rem;
-        }
-        
-        .stat-icon {
-            font-size: 3rem;
-            margin-bottom: 15px;
-            opacity: 0.7;
-        }
-        
-        .controls {
-            background: white;
-            border-radius: 15px;
-            padding: 25px;
-            margin-bottom: 30px;
-            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
-        }
-        
-        .controls-header {
-            display: flex;
-            justify-content: space-between;
-            align-items: center;
-            margin-bottom: 20px;
-        }
-        
-        .search-filters {
-            display: flex;
-            gap: 15px;
-            flex-wrap: wrap;
-        }
-        
-        .search-filters input,
-        .search-filters select {
-            padding: 10px 15px;
-            border: 2px solid #e9ecef;
-            border-radius: 10px;
-            font-size: 14px;
-        }
-        
-        .search-filters input:focus,
-        .search-filters select:focus {
-            outline: none;
-            border-color: #667eea;
-        }
-        
-        .btn {
-            padding: 10px 20px;
-            border: none;
-            border-radius: 10px;
-            cursor: pointer;
-            font-weight: 600;
-            transition: all 0.3s ease;
-            text-decoration: none;
-            display: inline-block;
-        }
-        
-        .btn-primary {
-            background: #667eea;
-            color: white;
-        }
-        
-        .btn-primary:hover {
-            background: #5a6fd8;
-        }
-        
-        .btn-success {
-            background: #28a745;
-            color: white;
-        }
-        
-        .btn-success:hover {
-            background: #218838;
-        }
-        
-        .btn-danger {
-            background: #dc3545;
-            color: white;
-        }
-        
-        .btn-danger:hover {
-            background: #c82333;
-        }
-        
-        .btn-warning {
-            background: #ffc107;
-            color: #333;
-        }
-        
-        .btn-warning:hover {
-            background: #e0a800;
-        }
-        
-        .data-table {
-            background: white;
-            border-radius: 15px;
-            overflow: hidden;
-            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
-        }
-        
-        .data-table table {
-            width: 100%;
-            border-collapse: collapse;
-        }
-        
-        .data-table th,
-        .data-table td {
-            padding: 15px;
-            text-align: right;
-            border-bottom: 1px solid #e9ecef;
-        }
-        
-        .data-table th {
-            background: #f8f9fa;
-            font-weight: 600;
-            color: #333;
-        }
-        
-        .data-table tr:hover {
-            background: #f8f9fa;
-        }
-        
-        .status-badge {
-            padding: 5px 12px;
-            border-radius: 20px;
-            font-size: 12px;
-            font-weight: 600;
-        }
-        
-        .status-pending {
-            background: #fff3cd;
-            color: #856404;
-        }
-        
-        .status-approved {
-            background: #d4edda;
-            color: #155724;
-        }
-        
-        .status-rejected {
-            background: #f8d7da;
-            color: #721c24;
-        }
-        
-        .form-group {
-            margin-bottom: 20px;
-        }
-        
-        .form-group label {
-            display: block;
-            margin-bottom: 8px;
-            font-weight: 600;
-            color: #333;
-        }
-        
-        .form-group input {
-            width: 100%;
-            padding: 12px 15px;
-            border: 2px solid #e9ecef;
-            border-radius: 10px;
-            font-size: 16px;
-        }
-        
-        .form-group input:focus {
-            outline: none;
-            border-color: #667eea;
-        }
-        
-        .alert {
-            padding: 15px;
-            border-radius: 10px;
-            margin: 20px 0;
-            display: none;
-        }
-        
-        .alert-success {
-            background: #d4edda;
-            color: #155724;
-            border: 1px solid #c3e6cb;
-        }
-        
-        .alert-error {
-            background: #f8d7da;
-            color: #721c24;
-            border: 1px solid #f5c6cb;
-        }
-        
-        .pagination {
-            display: flex;
-            justify-content: center;
-            gap: 10px;
-            margin: 20px 0;
-        }
-        
-        .pagination button {
-            padding: 10px 15px;
-            border: 2px solid #e9ecef;
-            background: white;
-            border-radius: 8px;
-            cursor: pointer;
-            transition: all 0.3s ease;
-        }
-        
-        .pagination button:hover {
-            border-color: #667eea;
-            background: #667eea;
-            color: white;
-        }
-        
-        .pagination button.active {
-            background: #667eea;
-            color: white;
-            border-color: #667eea;
-        }
-        
-        .pagination button:disabled {
-            cursor: not-allowed;
-            opacity: 0.5;
-        }
-        
-        .loading {
-            text-align: center;
-            padding: 40px;
-            display: none;
-        }
-        
-        .spinner {
-            border: 4px solid #f3f3f3;
-            border-top: 4px solid #667eea;
-            border-radius: 50%;
-            width: 40px;
-            height: 40px;
-            animation: spin 1s linear infinite;
-            margin: 0 auto 15px;
-        }
-        
-        @keyframes spin {
-            0% { transform: rotate(0deg); }
-            100% { transform: rotate(360deg); }
-        }
-        
-        .modal {
-            display: none;
-            position: fixed;
-            z-index: 1000;
-            left: 0;
-            top: 0;
-            width: 100%;
-            height: 100%;
-            background: rgba(0,0,0,0.5);
-        }
-        
-        .modal-content {
-            background: white;
-            margin: 5% auto;
-            padding: 30px;
-            border-radius: 15px;
-            width: 90%;
-            max-width: 600px;
-            max-height: 80vh;
-            overflow-y: auto;
-        }
-        
-        .modal-header {
-            display: flex;
-            justify-content: space-between;
-            align-items: center;
-            margin-bottom: 20px;
-            padding-bottom: 15px;
-            border-bottom: 1px solid #e9ecef;
-        }
-        
-        .close {
-            color: #aaa;
-            font-size: 28px;
-            font-weight: bold;
-            cursor: pointer;
-        }
-        
-        .close:hover {
-            color: #333;
-        }
-        
-        .action-buttons {
-            display: flex;
-            gap: 10px;
-            flex-wrap: wrap;
-        }
-        
-        .file-link {
-            display: inline-block;
-            padding: 8px 15px;
-            background: #e9ecef;
-            border-radius: 8px;
-            text-decoration: none;
-            color: #333;
-            transition: background 0.3s ease;
-        }
-        
-        .file-link:hover {
-            background: #dee2e6;
-            text-decoration: none;
-            color: #333;
-        }
-        
-        @media (max-width: 768px) {
-            .main-content {
-                padding: 15px;
-            }
-            
-            .search-filters {
-                flex-direction: column;
-            }
-            
-            .search-filters input,
-            .search-filters select {
-                width: 100%;
-            }
-            
-            .data-table {
-                overflow-x: auto;
-            }
-            
-            .action-buttons {
-                flex-direction: column;
-            }
-            
-            .header {
-                flex-direction: column;
-                gap: 15px;
-                text-align: center;
-            }
-        }
-    </style>
-</head>
-<body>
-    <!-- نموذج تسجيل الدخول -->
-    <div class="login-container" id="loginContainer">
-        <div class="login-form">
-            <div class="logo">
-                <i class="fas fa-shield-alt"></i>
-            </div>
-            <h2 style="margin-bottom: 30px; color: #333;">لوحة التحكم</h2>
-            <p style="color: #666; margin-bottom: 30px;">تسجيل الدخول للوصول إلى لوحة الإدارة</p>
-            
-            <div class="alert alert-error" id="loginError"></div>
-            
-            <form id="loginForm">
-                <div class="form-group">
-                    <label for="username">اسم المستخدم</label>
-                    <input type="text" id="username" name="username" required>
-                </div>
-                
-                <div class="form-group">
-                    <label for="password">كلمة المرور</label>
-                    <input type="password" id="password" name="password" required>
-                </div>
-                
-                <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 20px;">
-                    <i class="fas fa-sign-in-alt"></i> تسجيل الدخول
-                </button>
-            </form>
-            
-            <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #eee;">
-                <p style="color: #666; font-size: 0.9rem;">
-                    اسم المستخدم الافتراضي: <strong>admin</strong><br>
-                    كلمة المرور الافتراضية: <strong>admin123</strong>
-                </p>
-            </div>
-            
-            <a href="/home.html" style="display: inline-block; margin-top: 20px; color: #667eea; text-decoration: none;">
-                <i class="fas fa-arrow-right"></i> العودة للرئيسية
-            </a>
-        </div>
-    </div>
-    
-    <!-- لوحة التحكم -->
-    <div class="dashboard-container" id="dashboardContainer">
-        <div class="header">
-            <h1><i class="fas fa-tachometer-alt"></i> لوحة التحكم</h1>
-            <div class="user-info">
-                <span id="welcomeMessage">مرحباً، المدير</span>
-                <button class="logout-btn" onclick="logout()">
-                    <i class="fas fa-sign-out-alt"></i> تسجيل الخروج
-                </button>
-            </div>
-        </div>
-        
-        <div class="main-content">
-            <!-- الإحصائيات -->
-            <div class="stats-grid">
-                <div class="stat-card total">
-                    <div class="stat-icon" style="color: #667eea;">
-                        <i class="fas fa-users"></i>
-                    </div>
-                    <div class="stat-number" id="totalStat">-</div>
-                    <div class="stat-label">إجمالي التسجيلات</div>
-                </div>
-                
-                <div class="stat-card pending">
-                    <div class="stat-icon" style="color: #ffc107;">
-                        <i class="fas fa-clock"></i>
-                    </div>
-                    <div class="stat-number" id="pendingStat">-</div>
-                    <div class="stat-label">في الانتظار</div>
-                </div>
-                
-                <div class="stat-card approved">
-                    <div class="stat-icon" style="color: #28a745;">
-                        <i class="fas fa-check-circle"></i>
-                    </div>
-                    <div class="stat-number" id="approvedStat">-</div>
-                    <div class="stat-label">مقبول</div>
-                </div>
-                
-                <div class="stat-card rejected">
-                    <div class="stat-icon" style="color: #dc3545;">
-                        <i class="fas fa-times-circle"></i>
-                    </div>
-                    <div class="stat-number" id="rejectedStat">-</div>
-                    <div class="stat-label">مرفوض</div>
-                </div>
-            </div>
-            
-            <!-- أدوات التحكم -->
-            <div class="controls">
-                <div class="controls-header">
-                    <h3><i class="fas fa-filter"></i> إدارة التسجيلات</h3>
-                    <button class="btn btn-success" onclick="exportToExcel()">
-                        <i class="fas fa-file-excel"></i> تصدير Excel
-                    </button>
-                </div>
-                
-                <div class="search-filters">
-                    <input type="text" id="searchInput" placeholder="البحث (الاسم، الهوية، الجوال، رقم التسجيل)">
-                    
-                    <select id="statusFilter">
-                        <option value="">جميع الحالات</option>
-                        <option value="pending">في الانتظار</option>
-                        <option value="approved">مقبول</option>
-                        <option value="rejected">مرفوض</option>
-                    </select>
-                    
-                    <button class="btn btn-primary" onclick="loadRegistrations()">
-                        <i class="fas fa-search"></i> بحث
-                    </button>
-                    
-                    <button class="btn btn-warning" onclick="clearFilters()">
-                        <i class="fas fa-eraser"></i> مسح
-                    </button>
-                </div>
-            </div>
-            
-            <div class="alert alert-success" id="successAlert"></div>
-            <div class="alert alert-error" id="errorAlert"></div>
-            
-            <!-- جدول البيانات -->
-            <div class="data-table">
-                <div class="loading" id="tableLoading">
-                    <div class="spinner"></div>
-                    <p>جاري تحميل البيانات...</p>
-                </div>
-                
-                <table id="registrationsTable" style="display: none;">
-                    <thead>
-                        <tr>
-                            <th>رقم التسجيل</th>
-                            <th>الاسم الكامل</th>
-                            <th>رقم الهوية</th>
-                            <th>رقم الجوال</th>
-                            <th>التطبيق</th>
-                            <th>الحالة</th>
-                            <th>تاريخ التسجيل</th>
-                            <th>الإجراءات</th>
-                        </tr>
-                    </thead>
-                    <tbody id="registrationsBody">
-                    </tbody>
-                </table>
-                
-                <div class="pagination" id="pagination"></div>
-            </div>
-        </div>
-    </div>
-    
-    <!-- نافذة تفاصيل التسجيل -->
-    <div id="detailsModal" class="modal">
-        <div class="modal-content">
-            <div class="modal-header">
-                <h3><i class="fas fa-user"></i> تفاصيل التسجيل</h3>
-                <span class="close" onclick="closeModal()">&times;</span>
-            </div>
-            <div id="modalContent"></div>
-        </div>
-    </div>
-
-    <script>
-        let currentUser = null;
-        let currentPage = 1;
-        let totalPages = 1;
-        let registrationsData = [];
-        
-        // تسجيل الدخول
-        document.getElementById('loginForm').addEventListener('submit', async function(e) {
-            e.preventDefault();
-            
-            const username = document.getElementById('username').value;
-            const password = document.getElementById('password').value;
-            
-            try {
-                const response = await fetch('/api/login', {
-                    method: 'POST',
-                    headers: {
-                        'Content-Type': 'application/json'
-                    },
-                    body: JSON.stringify({ username, password })
-                });
-                
-                const data = await response.json();
-                
-                if (data.success) {
-                    currentUser = data.user;
-                    localStorage.setItem('authToken', data.token);
-                    localStorage.setItem('currentUser', JSON.stringify(data.user));
-                    
-                    showDashboard();
-                } else {
-                    showAlert(data.message || 'فشل تسجيل الدخول', 'error', 'loginError');
-                }
-            } catch (error) {
-                showAlert('خطأ في الاتصال', 'error', 'loginError');
-            }
-        });
-        
-        // إظهار لوحة التحكم
-        function showDashboard() {
-            document.getElementById('loginContainer').style.display = 'none';
-            document.getElementById('dashboardContainer').style.display = 'block';
-            
-            if (currentUser) {
-                document.getElementById('welcomeMessage').textContent = `مرحباً، ${currentUser.fullName}`;
-            }
-            
-            loadStatistics();
-            loadRegistrations();
-        }
-        
-        // تحميل الإحصائيات
-        async function loadStatistics() {
-            try {
-                const token = localStorage.getItem('authToken');
-                const response = await fetch('/api/statistics', {
-                    headers: {
-                        'Authorization': `Bearer ${token}`
-                    }
-                });
-                
-                if (response.ok) {
-                    const data = await response.json();
-                    if (data.success) {
-                        document.getElementById('totalStat').textContent = data.total || 0;
-                        document.getElementById('pendingStat').textContent = data.pending || 0;
-                        document.getElementById('approvedStat').textContent = data.approved || 0;
-                        document.getElementById('rejectedStat').textContent = data.rejected || 0;
-                    }
-                }
-            } catch (error) {
-                console.error('فشل تحميل الإحصائيات:', error);
-            }
-        }
-        
-        // تحميل التسجيلات
-        async function loadRegistrations(page = 1) {
-            const tableLoading = document.getElementById('tableLoading');
-            const table = document.getElementById('registrationsTable');
-            
-            tableLoading.style.display = 'block';
-            table.style.display = 'none';
-            
-            try {
-                const token = localStorage.getItem('authToken');
-                const search = document.getElementById('searchInput').value;
-                const status = document.getElementById('statusFilter').value;
-                
-                const params = new URLSearchParams({
-                    page: page,
-                    limit: 10,
-                    search: search,
-                    status: status
-                });
-                
-                const response = await fetch(`/api/registrations?${params}`, {
-                    headers: {
-                        'Authorization': `Bearer ${token}`
-                    }
-                });
-                
-                if (response.ok) {
-                    const data = await response.json();
-                    if (data.success) {
-                        registrationsData = data.registrations;
-                        currentPage = data.currentPage;
-                        totalPages = data.totalPages;
-                        
-                        displayRegistrations(data.registrations);
-                        displayPagination();
-                    }
-                } else {
-                    showAlert('فشل تحميل البيانات', 'error');
-                }
-            } catch (error) {
-                showAlert('خطأ في تحميل البيانات', 'error');
-            } finally {
-                tableLoading.style.display = 'none';
-                table.style.display = 'table';
-            }
-        }
-        
-        // عرض التسجيلات
-        function displayRegistrations(registrations) {
-            const tbody = document.getElementById('registrationsBody');
-            tbody.innerHTML = '';
-            
-            registrations.forEach(reg => {
-                const row = document.createElement('tr');
-                row.innerHTML = `
-                    <td>${reg.formNumber}</td>
-                    <td>${reg.fullName}</td>
-                    <td>${reg.idNumber}</td>
-                    <td>${reg.mobileNumber}</td>
-                    <td>${reg.selectedApp}</td>
-                    <td>
-                        <span class="status-badge status-${reg.status}">
-                            ${getStatusText(reg.status)}
-                        </span>
-                    </td>
-                    <td>${formatDate(reg.createdAt)}</td>
-                    <td>
-                        <div class="action-buttons">
-                            <button class="btn btn-primary" onclick="viewDetails(${reg.id})" style="font-size: 12px; padding: 5px 10px;">
-                                <i class="fas fa-eye"></i> عرض
-                            </button>
-                            ${reg.status === 'pending' ? `
-                                <button class="btn btn-success" onclick="updateStatus(${reg.id}, 'approved')" style="font-size: 12px; padding: 5px 10px;">
-                                    <i class="fas fa-check"></i> قبول
-                                </button>
-                                <button class="btn btn-danger" onclick="updateStatus(${reg.id}, 'rejected')" style="font-size: 12px; padding: 5px 10px;">
-                                    <i class="fas fa-times"></i> رفض
-                                </button>
-                            ` : ''}
-                        </div>
-                    </td>
-                `;
-                tbody.appendChild(row);
-            });
-        }
-        
-        // عرض الترقيم
-        function displayPagination() {
-            const pagination = document.getElementById('pagination');
-            pagination.innerHTML = '';
-            
-            // زر السابق
-            const prevBtn = document.createElement('button');
-            prevBtn.innerHTML = '<i class="fas fa-chevron-right"></i>';
-            prevBtn.disabled = currentPage === 1;
-            prevBtn.onclick = () => loadRegistrations(currentPage - 1);
-            pagination.appendChild(prevBtn);
-            
-            // أرقام الصفحات
-            for (let i = 1; i <= totalPages; i++) {
-                if (i === 1 || i === totalPages || (i >= currentPage - 2 && i <= currentPage + 2)) {
-                    const pageBtn = document.createElement('button');
-                    pageBtn.textContent = i;
-                    pageBtn.className = i === currentPage ? 'active' : '';
-                    pageBtn.onclick = () => loadRegistrations(i);
-                    pagination.appendChild(pageBtn);
-                } else if (i === currentPage - 3 || i === currentPage + 3) {
-                    const dots = document.createElement('span');
-                    dots.textContent = '...';
-                    dots.style.padding = '10px';
-                    pagination.appendChild(dots);
-                }
-            }
-            
-            // زر التالي
-            const nextBtn = document.createElement('button');
-            nextBtn.innerHTML = '<i class="fas fa-chevron-left"></i>';
-            nextBtn.disabled = currentPage === totalPages;
-            nextBtn.onclick = () => loadRegistrations(currentPage + 1);
-            pagination.appendChild(nextBtn);
-        }
-        
-        // عرض تفاصيل التسجيل
-        async function viewDetails(id) {
-            try {
-                const token = localStorage.getItem('authToken');
-                const response = await fetch(`/api/registrations/${id}`, {
-                    headers: {
-                        'Authorization': `Bearer ${token}`
-                    }
-                });
-                
-                if (response.ok) {
-                    const reg = await response.json();
-                    showDetailsModal(reg);
-                } else {
-                    showAlert('فشل تحميل التفاصيل', 'error');
-                }
-            } catch (error) {
-                showAlert('خطأ في تحميل التفاصيل', 'error');
-            }
-        }
-        
-        // إظهار نافذة التفاصيل
-        function showDetailsModal(reg) {
-            const modalContent = document.getElementById('modalContent');
-            modalContent.innerHTML = `
-                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
-                    <div>
-                        <h4 style="margin-bottom: 15px; color: #333;">المعلومات الأساسية</h4>
-                        <p><strong>رقم التسجيل:</strong> ${reg.formNumber}</p>
-                        <p><strong>الاسم الكامل:</strong> ${reg.fullName}</p>
-                        <p><strong>رقم الهوية:</strong> ${reg.idNumber}</p>
-                        <p><strong>رقم الجوال:</strong> ${reg.mobileNumber}</p>
-                        <p><strong>رقم STC Pay:</strong> ${reg.stcPayNumber}</p>
-                        <p><strong>التطبيق:</strong> ${reg.selectedApp}</p>
-                        <p><strong>الحالة:</strong> 
-                            <span class="status-badge status-${reg.status}">
-                                ${getStatusText(reg.status)}
-                            </span>
-                        </p>
-                        <p><strong>تاريخ التسجيل:</strong> ${formatDate(reg.createdAt)}</p>
-                    </div>
-                    
-                    <div>
-                        <h4 style="margin-bottom: 15px; color: #333;">المستندات</h4>
-                        <p><strong>صورة الهوية:</strong> 
-                            <a href="/uploads/id-documents/${reg.idCopyFile}" target="_blank" class="file-link">
-                                <i class="fas fa-eye"></i> عرض
-                            </a>
-                        </p>
-                        <p><strong>صورة الرخصة:</strong> 
-                            <a href="/uploads/licenses/${reg.licenseCopyFile}" target="_blank" class="file-link">
-                                <i class="fas fa-eye"></i> عرض
-                            </a>
-                        </p>
-                        <p><strong>الصورة الشخصية:</strong> 
-                            <a href="/uploads/face-photos/${reg.facePhotoFile}" target="_blank" class="file-link">
-                                <i class="fas fa-eye"></i> عرض
-                            </a>
-                        </p>
-                        
-                        <h4 style="margin: 20px 0 15px; color: #333;">معلومات تقنية</h4>
-                        <p><strong>عنوان IP:</strong> ${reg.ipAddress}</p>
-                        <p><strong>التحقق من الجوال:</strong> ${reg.isPhoneVerified ? 'تم' : 'لم يتم'}</p>
-                    </div>
-                </div>
-                
-                ${reg.status === 'pending' ? `
-                    <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #eee;">
-                        <h4 style="margin-bottom: 15px; color: #333;">إجراءات سريعة</h4>
-                        <div class="action-buttons">
-                            <button class="btn btn-success" onclick="updateStatus(${reg.id}, 'approved'); closeModal();">
-                                <i class="fas fa-check"></i> قبول التسجيل
-                            </button>
-                            <button class="btn btn-danger" onclick="updateStatus(${reg.id}, 'rejected'); closeModal();">
-                                <i class="fas fa-times"></i> رفض التسجيل
-                            </button>
-                        </div>
-                    </div>
-                ` : ''}
-            `;
-            
-            document.getElementById('detailsModal').style.display = 'block';
-        }
-        
-        // تحديث حالة التسجيل
-        async function updateStatus(id, status) {
-            if (!confirm(`هل أنت متأكد من ${status === 'approved' ? 'قبول' : 'رفض'} هذا التسجيل؟`)) {
-                return;
-            }
-            
-            try {
-                const token = localStorage.getItem('authToken');
-                const response = await fetch(`/api/registrations/${id}/status`, {
-                    method: 'PUT',
-                    headers: {
-                        'Authorization': `Bearer ${token}`,
-                        'Content-Type': 'application/json'
-                    },
-                    body: JSON.stringify({ status })
-                });
-                
-                const data = await response.json();
-                
-                if (data.success) {
-                    showAlert('تم تحديث الحالة بنجاح', 'success');
-                    loadStatistics();
-                    loadRegistrations(currentPage);
-                } else {
-                    showAlert(data.message || 'فشل تحديث الحالة', 'error');
-                }
-            } catch (error) {
-                showAlert('خطأ في تحديث الحالة', 'error');
-            }
-        }
-        
-        // تصدير البيانات
-        async function exportToExcel() {
-            try {
-                const token = localStorage.getItem('authToken');
-                const response = await fetch('/api/export-excel', {
-                    headers: {
-                        'Authorization': `Bearer ${token}`
-                    }
-                });
-                
-                if (response.ok) {
-                    const blob = await response.blob();
-                    const url = window.URL.createObjectURL(blob);
-                    const a = document.createElement('a');
-                    a.href = url;
-                    a.download = `delivery-registrations-${new Date().toISOString().split('T')[0]}.xlsx`;
-                    document.body.appendChild(a);
-                    a.click();
-                    window.URL.revokeObjectURL(url);
-                    document.body.removeChild(a);
-                    
-                    showAlert('تم تصدير البيانات بنجاح', 'success');
-                } else {
-                    showAlert('فشل تصدير البيانات', 'error');
-                }
-            } catch (error) {
-                showAlert('خطأ في تصدير البيانات', 'error');
-            }
-        }
-        
-        // مسح المرشحات
-        function clearFilters() {
-            document.getElementById('searchInput').value = '';
-            document.getElementById('statusFilter').value = '';
-            loadRegistrations(1);
-        }
-        
-        // إغلاق النافذة المنبثقة
-        function closeModal() {
-            document.getElementById('detailsModal').style.display = 'none';
-        }
-        
-        // تسجيل الخروج
-        function logout() {
-            localStorage.removeItem('authToken');
-            localStorage.removeItem('currentUser');
-            currentUser = null;
-            
-            document.getElementById('dashboardContainer').style.display = 'none';
-            document.getElementById('loginContainer').style.display = 'flex';
-            
-            // مسح النموذج
-            document.getElementById('loginForm').reset();
-        }
-        
-        // دوال مساعدة
-        function getStatusText(status) {
-            const statusMap = {
-                'pending': 'في الانتظار',
-                'approved': 'مقبول',
-                'rejected': 'مرفوض'
-            };
-            return statusMap[status] || status;
-        }
-        
-        function formatDate(dateString) {
-            const date = new Date(dateString);
-            return date.toLocaleDateString('ar-SA') + ' ' + date.toLocaleTimeString('ar-SA', {
-                hour: '2-digit',
-                minute: '2-digit'
-            });
-        }
-        
-        function showAlert(message, type, elementId = null) {
-            const alertElement = elementId ? 
-                document.getElementById(elementId) : 
-                document.getElementById(type === 'error' ? 'errorAlert' : 'successAlert');
-            
-            alertElement.textContent = message;
-            alertElement.style.display = 'block';
-            
-            // إخفاء التنبيهات الأخرى
-            if (!elementId) {
-                const otherAlert = type === 'error' ? 
-                    document.getElementById('successAlert') : 
-                    document.getElementById('errorAlert');
-                otherAlert.style.display = 'none';
-            }
-            
-            setTimeout(() => {
-                alertElement.style.display = 'none';
-            }, 5000);
-        }
-        
-        // التحقق من الجلسة عند تحميل الصفحة
-        window.addEventListener('load', function() {
-            const token = localStorage.getItem('authToken');
-            const user = localStorage.getItem('currentUser');
-            
-            if (token && user) {
-                currentUser = JSON.parse(user);
-                showDashboard();
-            }
-            
-            // إضافة مستمع البحث
-            document.getElementById('searchInput').addEventListener('keypress', function(e) {
-                if (e.key === 'Enter') {
-                    loadRegistrations(1);
-                }
-            });
-            
-            // إغلاق النافذة المنبثقة عند النقر خارجها
-            window.onclick = function(event) {
-                const modal = document.getElementById('detailsModal');
-                if (event.target === modal) {
-                    modal.style.display = 'none';
-                }
-            };
-        });
-    </script>
-</body>
-</html>
-- 
2.43.0

